[program:laravel-worker]
; プロセス名の設定（複数プロセス時に番号を付与）
process_name=%(program_name)s_%(process_num)02d

; 実行するコマンド（Laravelキューワーカー）
command=php /var/www/project/artisan queue:work database --sleep=3 --tries=3 --max-time=3600

; supervisor起動時に自動でプロセスを開始
autostart=true

; プロセスが停止した場合に自動で再起動
autorestart=true

; プロセス停止時にグループ全体を停止
stopasgroup=true

; プロセス強制終了時にグループ全体を強制終了
killasgroup=true

; 実行ユーザー（セキュリティのためwww-dataで実行）
user=www-data

; 起動するプロセス数（並列処理のため2つ）
numprocs=2

; 標準エラーを標準出力にリダイレクト
redirect_stderr=true

; ログファイルの出力先
stdout_logfile=/var/www/project/storage/logs/worker.log

; プロセス停止時の待機時間（秒）
stopwaitsecs=3600
